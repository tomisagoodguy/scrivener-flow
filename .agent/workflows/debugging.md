---
name: systematic-debugging
description: 執行四階段的系統化除錯流程。適用於調查 Bug、修復測試失敗或處理非預期行為。當使用者提出「幫我看看哪裡錯了」、「修復這個 Bug」、「為什麼壞掉了」或貼上錯誤訊息時啟用。
version: 1.1.0
---

# 系統化除錯指南 (Systematic Debugging)

當使用者要求「除錯 (Debug)」、「修復 Bug」或遇到錯誤訊息時，請嚴格遵守此流程。

## 核心原則 (Core Principle)

**🚫 在找出根本原因 (Root Cause) 之前，禁止寫 Code 修復。**
不要使用「貼貼看補丁」的方式來掩蓋症狀。必須理解「為什麼」會失敗。

## 四階段框架 (The Four-Phase Framework)

### 第一階段：根本原因調查 (Root Cause Investigation)

在高觸碰任何程式碼之前：

1. **徹底閱讀錯誤訊息**：每一個字都很重要。
2. **重現問題**：如果你不能穩定重現它，你就無法驗證修復。
3. **檢查最近變更**：在開始失敗之前，改了什麼？
4. **追蹤資料流 (Data Flow)**：不要只看錯誤發生的地方，要往上游追溯壞掉的資料是從哪裡來的。

### 第二階段：模式分析 (Pattern Analysis)

- 找出類似且**運作正常**的程式碼範例。
- 仔細比對差異（Diff）。
- 理解相依性關係。

### 第三階段：假設與測試 (Hypothesis and Testing)

使用科學方法：

1. 提出一個明確的假設：「錯誤發生是因為 X」。
2. 設計一個最小測試來驗證。
3. 如果假設錯誤，重新修正假設；如果正確，才進入下一階段。

### 第四階段：實作 (Implementation)

1. **建立會失敗的測試案例 (Failing Test Case)**：捕捉 Bug 的行為。
2. **實作修復**：針對根本原因解決，而非症狀。
3. **驗證測試通過**。

## 紅色警報 (Red Flags)

如果你發現自己有以下想法，請**立即停止**並重新思考：

- 🚩 「先快速修一下，之後再調查。」
- 🚩 「再試試看這個修法...」（已經失敗多次後）
- 🚩 「這應該要能跑啊。」（卻不知道為什麼不能跑）
- 🚩 「在我電腦上是好的。」

## 輸出要求

在協助除錯時，請依照上述步驟引導使用者，並清楚說明目前的分析階段。

## 範例 (Examples)

### 狀況：API 回傳 404

1. **調查**：檢查 Request URL 是否正確？Payload 是否符合 Schema？
2. **分析**：比對後台 Route 定義。
3. **假設**：假設是環境變數 `API_URL` 在編譯時未正確植入。
4. **實作**：修正 `.env` 並重啟伺服器。
